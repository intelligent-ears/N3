# N3 Security Scanner - System Architecture

## High-Level Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           N3 SECURITY SCANNER                               |
â”‚                    Template-Based Vulnerability Detection                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CORE ENGINE (packages/core/)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    TEMPLATE LIBRARY (40+ YAML Files)                 â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  ğŸ“ SWC Templates (20+)          ğŸ“ DeFi Templates (10+)            â”‚   â”‚
â”‚  â”‚  â”œâ”€ reentrancy-001.yaml          â”œâ”€ flash-loan-001.yaml              â”‚   â”‚
â”‚  â”‚  â”œâ”€ integer-overflow-001.yaml    â”œâ”€ oracle-manipulation.yaml         â”‚   â”‚
â”‚  â”‚  â”œâ”€ access-control-001.yaml      â”œâ”€ frontrunning-001.yaml            â”‚   â”‚
â”‚  â”‚  â”œâ”€ unchecked-call.yaml          â”œâ”€ liquidity-drain.yaml             â”‚   â”‚
â”‚  â”‚  â””â”€ ... (16 more)                â””â”€ ... (6 more)                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  ğŸ“ Smart Contract Templates (10+)                                	  â”‚   â”‚
â”‚  â”‚  â”œâ”€ upgrade-proxy-001.yaml                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€ delegatecall-001.yaml                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€ selfdestruct-001.yaml                                            â”‚   â”‚
â”‚  â”‚  â””â”€ ... (7 more)                                                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         SCANNING ENGINE                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â€¢ Template Parser (YAML â†’ Executable Rules)                         â”‚   â”‚
â”‚  â”‚  â€¢ Pattern Matcher (Solidity AST Analysis)                           â”‚   â”‚
â”‚  â”‚  â€¢ Risk Calculator (Severity Ã— Impact Ã— Exploitability)              â”‚   â”‚
â”‚  â”‚  â€¢ CVE Mapper (Known Vulnerabilities Database)                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   DELIVERY PLATFORMS (3)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼

        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼                   â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   HARDHAT       â”‚ â”‚   BLOCKSCOUT    â”‚ â”‚     ENVIO       â”‚ â”‚   MCP SERVER    â”‚
â”‚   INTEGRATION   â”‚ â”‚   INTEGRATION   â”‚ â”‚   INTEGRATION   â”‚ â”‚   INTEGRATION   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚
â”‚  Compilation    â”‚ â”‚  Widget UI      â”‚ â”‚  Real-Time      â”‚ â”‚  AI-Powered     â”‚
â”‚    Time Scan    â”‚ â”‚    Embedded     â”‚ â”‚    Indexing     â”‚ â”‚    Analysis     â”‚
â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚
â”‚ â€¢ Runs during   â”‚ â”‚ â€¢ Contract page â”‚ â”‚ â€¢ Event stream  â”‚ â”‚ â€¢ Natural lang. â”‚
â”‚   npx hardhat   â”‚ â”‚   security      â”‚ â”‚   monitoring    â”‚ â”‚   explanations  â”‚
â”‚   compile       â”‚ â”‚   badge         â”‚ â”‚ â€¢ GraphQL API   â”‚ â”‚ â€¢ Blockscout    â”‚
â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚ â”‚   API proxy     â”‚
â”‚ â€¢ Blocks bad    â”‚ â”‚ â€¢ Live risk     â”‚ â”‚ â€¢ Analytics     â”‚ â”‚                 â”‚
â”‚   deployments   â”‚ â”‚   score         â”‚ â”‚   dashboard     â”‚ â”‚ â€¢ Security      â”‚
â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚ â”‚   prompts       â”‚
â”‚ â€¢ Risk report   â”‚ â”‚ â€¢ Vulnerability â”‚ â”‚ â€¢ Alert system  â”‚ â”‚                 â”‚
â”‚   in terminal   â”‚ â”‚   list          â”‚ â”‚                 â”‚ â”‚                 â”‚
â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚ â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   STORAGE LAYER       â”‚
                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                        â”‚ â€¢ Smart Contract      â”‚
                        â”‚   (N3SecurityOracle)  â”‚
                        â”‚ â€¢ PostgreSQL DB       â”‚
                        â”‚ â€¢ Hasura GraphQL      â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Detailed Component Architecture

### 1ï¸âƒ£ CORE ENGINE - Template System

```
packages/core/
â”‚
â”œâ”€â”€ templates/                          â† 40+ YAML vulnerability definitions
â”‚   â”œâ”€â”€ SWC/
â”‚   â”‚   â”œâ”€â”€ SWC-107-reentrancy.yaml
â”‚   â”‚   â”œâ”€â”€ SWC-101-integer-overflow.yaml
â”‚   â”‚   â”œâ”€â”€ SWC-105-unprotected-ether.yaml
â”‚   â”‚   â””â”€â”€ ... (17 more)
â”‚   â”‚
â”‚   â”œâ”€â”€ defi/
â”‚   â”‚   â”œâ”€â”€ flash-loan-attack.yaml
â”‚   â”‚   â”œâ”€â”€ oracle-manipulation.yaml
â”‚   â”‚   â”œâ”€â”€ frontrunning.yaml
â”‚   â”‚   â””â”€â”€ ... (7 more)
â”‚   â”‚
â”‚   â””â”€â”€ smart-contract/
â”‚       â”œâ”€â”€ delegatecall-injection.yaml
â”‚       â”œâ”€â”€ selfdestruct-abuse.yaml
â”‚       â””â”€â”€ ... (8 more)
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ engine.ts                       â† Main scanning orchestrator
â”‚   â”œâ”€â”€ parser.ts                       â† Solidity AST parser
â”‚   â”œâ”€â”€ cve-scanner.ts                  â† Template matcher
â”‚   â”œâ”€â”€ cve-parser.ts                   â† YAML â†’ Rules converter
â”‚   â””â”€â”€ index.ts                        â† Public API
â”‚
â””â”€â”€ package.json
```

**Template Structure (YAML):**
```yaml
id: reentrancy-001
name: Reentrancy Vulnerability
severity: CRITICAL
category: SWC-107
description: Contract calls external address before state update
impact: Allows attacker to drain contract funds
remediation: Use checks-effects-interactions pattern

patterns:
  - pattern: call.value(...)
    before: storage_write
    risk: HIGH
    
  - pattern: delegatecall(...)
    context: external_contract
    risk: CRITICAL

test_cases:
  - vulnerable: |
      function withdraw() public {
        msg.sender.call.value(balance[msg.sender])("");
        balance[msg.sender] = 0;  // âš ï¸ State change AFTER external call
      }
      
  - safe: |
      function withdraw() public {
        uint amount = balance[msg.sender];
        balance[msg.sender] = 0;  // âœ… State change BEFORE external call
        msg.sender.call.value(amount)("");
      }
```

---

### 2ï¸âƒ£ HARDHAT INTEGRATION - Build-Time Scanning

```
packages/hardhat-plugin/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                        â† Hardhat plugin entry point
â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”œâ”€â”€ compile-hook.ts             â† Intercepts compilation
â”‚   â”‚   â”œâ”€â”€ scan-task.ts                â† Manual scan command
â”‚   â”‚   â””â”€â”€ report-task.ts              â† Generate reports
â”‚   â”‚
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ contract-loader.ts          â† Load compiled artifacts
â”‚       â””â”€â”€ report-formatter.ts         â† Terminal output formatting
â”‚
â””â”€â”€ package.json

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HARDHAT WORKFLOW                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Developer runs:                                                â”‚
â”‚  $ npx hardhat compile                                          â”‚
â”‚                                                                 â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚ Solidity Compile â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚ N3 Plugin Hook   â”‚  â† Runs automatically                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Load Templates (40+ YAML)        â”‚                           â”‚
â”‚  â”‚ Parse Compiled Bytecode + AST    â”‚                           â”‚
â”‚  â”‚ Match Vulnerability Patterns     â”‚                           â”‚
â”‚  â”‚ Calculate Risk Score             â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚ Terminal Report  â”‚                                           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                           â”‚
â”‚  â”‚  0 Critical      â”‚                                           â”‚
â”‚  â”‚  2 High          â”‚                                           â”‚
â”‚  â”‚  Risk: 65/100    â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚ Block Deploy?    â”‚  â† If risk > threshold                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Usage Example:**
```javascript
// hardhat.config.js
require('@n3/hardhat-plugin');

module.exports = {
  solidity: "0.8.20",
  n3: {
    enabled: true,
    threshold: 70,          // Fail compilation if score < 70
    templates: './templates', // Custom template directory
    output: './reports',    // Save scan reports
  }
};
```

---

### 3ï¸âƒ£ BLOCKSCOUT INTEGRATION - Explorer Widget

```
packages/blockscout-widget/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ widget.tsx                      â† React widget component
â”‚   â”œâ”€â”€ api-client.ts                   â† Blockscout API wrapper
â”‚   â””â”€â”€ index.ts                        â† Export bundle
â”‚
â”œâ”€â”€ rollup.config.js                    â† Build UMD bundle
â””â”€â”€ package.json

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BLOCKSCOUT WIDGET ARCHITECTURE                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  User views contract on Blockscout:                             â”‚
â”‚  https://eth.blockscout.com/address/0x123...                    â”‚
â”‚                                                                 â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚  Blockscout Contract Page        â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                           â”‚
â”‚  â”‚  â”‚ Contract Details           â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ â€¢ Name: TetherToken        â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ â€¢ Verified:                â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ â€¢ Compiler: v0.4.18        â”‚  â”‚                           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                           â”‚
â”‚  â”‚                                  â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                           â”‚
â”‚  â”‚  â”‚  N3 Security Widget        â”‚  â”‚  â† Embedded via <script>  â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚                           â”‚
â”‚  â”‚  â”‚ Risk Score: 45/100         â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚                            â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚   3 Critical Issues:       â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ â€¢ Reentrancy in withdraw() â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ â€¢ Missing access control   â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ â€¢ Integer overflow risk    â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚                            â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ [View Full Report]         â”‚  â”‚                           â”‚
â”‚  â”‚  â”‚ [Request Audit]            â”‚  â”‚                           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Widget calls MCP Server API      â”‚                           â”‚
â”‚  â”‚ POST /api/analyze                â”‚                           â”‚
â”‚  â”‚ { contractAddress: "0x123..." }  â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ MCP Server:                      â”‚                           â”‚
â”‚  â”‚ 1. Fetch code from Blockscout    â”‚                           â”‚
â”‚  â”‚ 2. Run N3 template scan          â”‚                           â”‚
â”‚  â”‚ 3. Return JSON response          â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Widget Integration:**
```html
<!-- On Blockscout contract page -->
<div id="n3-security-widget"></div>

<script src="https://cdn.n3security.io/widget.js"></script>
<script>
  N3Widget.render({
    containerId: 'n3-security-widget',
    contractAddress: '{{contract.address}}',
    network: '{{chain.name}}',
    theme: 'light'
  });
</script>
```

---

### 4ï¸âƒ£ ENVIO INTEGRATION - Real-Time Monitoring

```
packages/envio-indexer/
â”‚
â”œâ”€â”€ config.yaml                         â† Network & contract config
â”œâ”€â”€ schema.graphql                      â† GraphQL schema definition
â”‚
â”œâ”€â”€ src/
â”‚   â””â”€â”€ EventHandlers.ts                â† Event processing logic
â”‚
â”œâ”€â”€ abis/
â”‚   â””â”€â”€ n3-security-oracle-abi.json    â† Contract ABI
â”‚
â””â”€â”€ generated/                          â† Auto-generated TypeScript types
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ Types.gen.ts
    â”‚   â””â”€â”€ Handlers.gen.ts
    â””â”€â”€ package.json

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ENVIO REAL-TIME INDEXING FLOW                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Smart Contract emits event:                                    â”‚
â”‚  N3SecurityOracle.VulnerabilityDetected(...)                    â”‚
â”‚                                                                 â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Envio HyperIndex (Listening)     â”‚                           â”‚
â”‚  â”‚ â€¢ Monitors blockchain events     â”‚                           â”‚
â”‚  â”‚ â€¢ Decodes event parameters       â”‚                           â”‚
â”‚  â”‚ â€¢ Triggers handler function      â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ EventHandler.ts                  â”‚                           â”‚
â”‚  â”‚ VulnerabilityDetected.handler()  â”‚                           â”‚
â”‚  â”‚ {                                â”‚                           â”‚
â”‚  â”‚   contractAddress: "0x123...",   â”‚                           â”‚
â”‚  â”‚   vulnType: "reentrancy",        â”‚                           â”‚
â”‚  â”‚   severity: "CRITICAL",          â”‚                           â”‚
â”‚  â”‚   timestamp: 1698264523          â”‚                           â”‚
â”‚  â”‚ }                                â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ PostgreSQL Database              â”‚                           â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                           â”‚
â”‚  â”‚ â”‚ vulnerability_event table    â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ â€¢ id                         â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ â€¢ contract_address           â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ â€¢ vulnerability_type         â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ â€¢ severity                   â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ â€¢ detected_at                â”‚ â”‚                           â”‚
â”‚  â”‚ â”‚ â€¢ block_number               â”‚ â”‚                           â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Hasura GraphQL API               â”‚                           â”‚
â”‚  â”‚ Auto-generated from DB schema    â”‚                           â”‚
â”‚  â”‚ http://localhost:8080/v1/graphql â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Security Dashboard (Frontend)    â”‚                           â”‚
â”‚  â”‚ â€¢ Real-time vulnerability feed   â”‚                           â”‚
â”‚  â”‚ â€¢ Analytics charts               â”‚                           â”‚
â”‚  â”‚ â€¢ Alert notifications            â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**GraphQL Query Example:**
```graphql
query GetCriticalVulnerabilities {
  VulnerabilityEvent(
    where: {
      severity: {_eq: "CRITICAL"},
      detectedAt: {_gte: "2025-10-01"}
    }
    order_by: {detectedAt: desc}
  ) {
    id
    contractAddress
    vulnerabilityType
    severity
    detectedAt
    blockNumber
  }
}

query GetSecurityMetrics {
  SecurityMetric(
    order_by: {criticalCount: desc}
    limit: 10
  ) {
    id
    totalScans
    criticalCount
    highCount
    mediumCount
    lowCount
  }
}
```

---

### 5ï¸âƒ£ MCP SERVER - AI Integration + Blockscout Proxy

```
mcp-blockscout-server.mjs
â”‚
â”œâ”€â”€ Express HTTP Server (Port 3000)
â”‚   â”‚
â”‚   â”œâ”€â”€ GET  /                          â† Health check
â”‚   â”œâ”€â”€ POST /api/analyze               â† Enhanced analysis
â”‚   â”œâ”€â”€ GET  /api/report/:address       â† Full security report
â”‚   â””â”€â”€ POST /api/prompt                â† MCP prompts
â”‚
â”œâ”€â”€ Blockscout API Client
â”‚   â”‚
â”‚   â”œâ”€â”€ queryBlockscout()               â† Direct API calls
â”‚   â”œâ”€â”€ getContractInfo()               â† Contract verification
â”‚   â””â”€â”€ getTransactionHistory()         â† Recent transactions
â”‚
â”œâ”€â”€ N3 Template Scanner
â”‚   â”‚
â”‚   â””â”€â”€ scanContract()                  â† Run vulnerability templates
â”‚
â””â”€â”€ MCP Protocol Handler
    â”‚
    â””â”€â”€ generatePrompt()                â† AI-friendly explanations

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MCP SERVER REQUEST FLOW                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Client (Widget/CLI/AI):                                        â”‚
â”‚  POST /api/analyze                                              â”‚
â”‚  { contractAddress: "0xdAC1..." }                               â”‚
â”‚                                                                 â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ MCP Server                       â”‚                           â”‚
â”‚  â”‚ Step 1: Fetch from Blockscout    â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Blockscout API                   â”‚                           â”‚
â”‚  â”‚ GET /api?module=contract&action= â”‚                           â”‚
â”‚  â”‚     getsourcecode&address=0x...  â”‚                           â”‚
â”‚  â”‚                                  â”‚                           â”‚
â”‚  â”‚ Returns:                         â”‚                           â”‚
â”‚  â”‚ â€¢ Source code                    â”‚                           â”‚
â”‚  â”‚ â€¢ Compiler version               â”‚                           â”‚
â”‚  â”‚ â€¢ Optimization settings          â”‚                           â”‚
â”‚  â”‚ â€¢ Contract name                  â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ MCP Server                       â”‚                           â”‚
â”‚  â”‚ Step 2: Run N3 Template Scan     â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ N3 Core Engine                   â”‚                           â”‚
â”‚  â”‚ â€¢ Load 40+ templates             â”‚                           â”‚
â”‚  â”‚ â€¢ Parse Solidity code            â”‚                           â”‚
â”‚  â”‚ â€¢ Match vulnerability patterns   â”‚                           â”‚
â”‚  â”‚ â€¢ Calculate risk score           â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ MCP Server                       â”‚                           â”‚
â”‚  â”‚ Step 3: Generate AI Prompt       â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚         â”‚                                                       â”‚
â”‚         â–¼                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Response:                        â”‚                           â”‚
â”‚  â”‚ {                                â”‚                           â”‚
â”‚  â”‚   contractAddress: "0xdAC1...",  â”‚                           â”‚
â”‚  â”‚   blockscout: {                  â”‚                           â”‚
â”‚  â”‚     verified: true,              â”‚                           â”‚
â”‚  â”‚     contractName: "TetherToken", â”‚                           â”‚
â”‚  â”‚     compiler: "v0.4.18"          â”‚                           â”‚
â”‚  â”‚   },                             â”‚                           â”‚
â”‚  â”‚   n3Security: {                  â”‚                           â”‚
â”‚  â”‚     riskScore: 45,               â”‚                           â”‚
â”‚  â”‚     vulnerabilities: [           â”‚                           â”‚
â”‚  â”‚       {                          â”‚                           â”‚
â”‚  â”‚         type: "reentrancy",      â”‚                           â”‚
â”‚  â”‚         severity: "CRITICAL",    â”‚                           â”‚
â”‚  â”‚         location: "withdraw()",  â”‚                           â”‚
â”‚  â”‚         remediation: "Use CEI"   â”‚                           â”‚
â”‚  â”‚       }                          â”‚                           â”‚
â”‚  â”‚     ]                            â”‚                           â”‚
â”‚  â”‚   },                             â”‚                           â”‚
â”‚  â”‚   aiPrompt: "This contract..."   â”‚                           â”‚
â”‚  â”‚ }                                â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Developer  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ (1) Writes Solidity code
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Smart Contract Source Code         â”‚
â”‚   â€¢ VulnerableBank.sol               â”‚
â”‚   â€¢ SecureBank.sol                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ (2) npx hardhat compile
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Hardhat Compilation                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ N3 Plugin Hook (Automatic)     â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ (3) Load templates & scan
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   N3 Core Engine                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ â€¢ Parse AST                    â”‚ â”‚
â”‚   â”‚ â€¢ Match 40+ templates          â”‚ â”‚
â”‚   â”‚ â€¢ Calculate risk score         â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                  â”‚                 â”‚                 â”‚
       â–¼                  â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Terminal   â”‚   â”‚  Contract   â”‚   â”‚   Envio     â”‚   â”‚ MCP Server  â”‚
â”‚   Report    â”‚   â”‚  Deployment â”‚   â”‚  Indexer    â”‚   â”‚   API       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Risk: 45/100â”‚   â”‚ Deploy to   â”‚   â”‚ Listen for  â”‚   â”‚ Serve to    â”‚
â”‚  CRITICAL   â”‚   â”‚ Blockchain  â”‚   â”‚ Events      â”‚   â”‚ Blockscout  â”‚
â”‚             â”‚   â”‚             â”‚   â”‚             â”‚   â”‚   Widget    â”‚
â”‚ Vulnera-    â”‚   â”‚ Emit        â”‚   â”‚ Store in    â”‚   â”‚             â”‚
â”‚ bilities:   â”‚   â”‚ Security    â”‚   â”‚ PostgreSQL  â”‚   â”‚ Generate    â”‚
â”‚ â€¢ Reentr... â”‚   â”‚ Events      â”‚   â”‚             â”‚   â”‚ AI Prompts  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚                 â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  N3SecurityOracle.sol    â”‚
                    â”‚  (On-Chain Storage)      â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ Events:                  â”‚
                    â”‚ â€¢ VulnerabilityDetected  â”‚
                    â”‚ â€¢ SecurityScanCompleted  â”‚
                    â”‚ â€¢ ContractDeployed       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Envio + Hasura          â”‚
                    â”‚  GraphQL API             â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ query {                  â”‚
                    â”‚   VulnerabilityEvent {   â”‚
                    â”‚     contractAddress      â”‚
                    â”‚     severity             â”‚
                    â”‚   }                      â”‚
                    â”‚ }                        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Security Dashboard      â”‚
                    â”‚  (Real-Time Analytics)   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      TECHNOLOGY STACK                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   CORE ENGINE                                                   â”‚
â”‚  â”œâ”€ TypeScript 5.2                                              â”‚
â”‚  â”œâ”€ Solidity Parser (@solidity-parser/parser)                   â”‚
â”‚  â”œâ”€ YAML Parser (js-yaml)                                       â”‚
â”‚  â””â”€ AST Walker (Custom implementation)                          â”‚
â”‚                                                                 â”‚
â”‚   HARDHAT INTEGRATION                                           â”‚
â”‚  â”œâ”€ Hardhat 3.0.9                                               â”‚
â”‚  â”œâ”€ @nomicfoundation/hardhat-ethers 4.0.2                       â”‚
â”‚  â”œâ”€ Ethers.js 6.8.0                                             â”‚
â”‚  â””â”€ Node.js 22.21.0                                             â”‚
â”‚                                                                 â”‚
â”‚   BLOCKSCOUT INTEGRATION                                        â”‚
â”‚  â”œâ”€ React 18.2                                                  â”‚
â”‚  â”œâ”€ TypeScript 5.2                                              â”‚
â”‚  â”œâ”€ Rollup (UMD bundler)                                        â”‚
â”‚  â”œâ”€ Blockscout API (REST)                                       â”‚
â”‚  â””â”€ Express 5.1.0 (MCP Server)                                  â”‚
â”‚                                                                 â”‚
â”‚   ENVIO INTEGRATION                                             â”‚
â”‚  â”œâ”€ Envio CLI 2.31.0                                            â”‚
â”‚  â”œâ”€ PostgreSQL 17.5                                             â”‚
â”‚  â”œâ”€ Hasura GraphQL 2.43.0                                       â”‚
â”‚  â”œâ”€ Docker Compose                                              â”‚
â”‚  â””â”€ TypeScript Event Handlers                                   â”‚
â”‚                                                                 â”‚
â”‚   MCP SERVER                                                    â”‚
â”‚  â”œâ”€ @modelcontextprotocol/sdk 1.20.2                            â”‚
â”‚  â”œâ”€ Express 5.1.0                                               â”‚
â”‚  â”œâ”€ Axios (HTTP client)                                         â”‚
â”‚  â””â”€ CORS + Body-parser                                          â”‚
â”‚                                                                 â”‚
â”‚   BLOCKCHAIN                                                    â”‚
â”‚  â”œâ”€ Solidity 0.8.20                                             â”‚
â”‚  â”œâ”€ Hardhat Local Node                                          â”‚
â”‚  â”œâ”€ Ethers.js 6.8.0                                             â”‚
â”‚  â””â”€ OpenZeppelin Contracts                                      â”‚
â”‚                                                                 â”‚
â”‚   PACKAGE MANAGEMENT                                            â”‚
â”‚  â”œâ”€ pnpm 10.19.0 (Workspace)                                    â”‚
â”‚  â”œâ”€ npm 10.9.4                                                  â”‚
â”‚  â””â”€ Monorepo Structure                                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRODUCTION DEPLOYMENT                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   USERS      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
                    â–¼                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Blockscout Widget  â”‚   â”‚  Developer CLI      â”‚
        â”‚  (Browser)          â”‚   â”‚  (Local Machine)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                         â”‚
                   â”‚ HTTPS                   â”‚ npx n3
                   â”‚                         â”‚
                   â–¼                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         MCP SERVER (Cloud)                   â”‚
        â”‚         https://api.n3security.io            â”‚
        â”‚                                              â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚  â”‚ Load Balancer (Nginx)                   â”‚ â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â”‚                    â”‚                         â”‚
        â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
        â”‚       â”‚                         â”‚            â”‚
        â”‚       â–¼                         â–¼            â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
        â”‚  â”‚ Node.js â”‚              â”‚ Node.js â”‚        â”‚
        â”‚  â”‚ Server  â”‚              â”‚ Server  â”‚        â”‚
        â”‚  â”‚ (Pod 1) â”‚              â”‚ (Pod 2) â”‚        â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                         â”‚
            â–¼                         â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Blockscout API    â”‚    â”‚ Blockchain RPC    â”‚
  â”‚ (External)        â”‚    â”‚ (Infura/Alchemy)  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚
            â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ N3 Core Engine    â”‚
  â”‚ (Container)       â”‚
  â”‚ â€¢ Template Cache  â”‚
  â”‚ â€¢ Scan Workers    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ PostgreSQL        â”‚
  â”‚ (Managed DB)      â”‚
  â”‚ â€¢ Scan Results    â”‚
  â”‚ â€¢ Analytics       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Hasura GraphQL    â”‚
  â”‚ (Cloud)           â”‚
  â”‚ â€¢ Public API      â”‚
  â”‚ â€¢ Real-time Subs  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Security & Privacy Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SECURITY CONSIDERATIONS                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   DATA PRIVACY                                                  â”‚
â”‚  â”œâ”€  Source code analysis is stateless (no storage)             â”‚
â”‚  â”œâ”€  Results cached with TTL (24 hours)                         â”‚
â”‚  â”œâ”€  No private keys stored                                     â”‚
â”‚  â””â”€  Public blockchain data only                                â”‚
â”‚                                                                 â”‚
â”‚   API SECURITY                                                  â”‚
â”‚  â”œâ”€  Rate limiting (100 req/min per IP)                         â”‚
â”‚  â”œâ”€  API key authentication (premium tier)                      â”‚
â”‚  â”œâ”€  CORS policies enforced                                     â”‚
â”‚  â””â”€  HTTPS only in production                                   â”‚
â”‚                                                                 â”‚
â”‚   TEMPLATE INTEGRITY                                            â”‚
â”‚  â”œâ”€  YAML schema validation                                     â”‚
â”‚  â”œâ”€  Template signatures (community submissions)                â”‚
â”‚  â”œâ”€  Version control (Git history)                              â”‚
â”‚  â””â”€  Peer review process                                        â”‚
â”‚                                                                 â”‚
â”‚   SCAN ACCURACY                                                 â”‚
â”‚  â”œâ”€  Multiple template sources (SWC, CVE, DeFi hacks)           â”‚
â”‚  â”œâ”€  Conservative risk scoring (minimize false negatives)       â”‚
â”‚  â”œâ”€  Template test cases (vulnerable vs safe code)              â”‚
â”‚  â””â”€  Disclaimer: Tool assistance, not audit guarantee           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Scalability Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SCALABILITY STRATEGY                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   HORIZONTAL SCALING                                            â”‚
â”‚  â”œâ”€ MCP Server: Kubernetes pods (auto-scale)                    â”‚
â”‚  â”œâ”€ Scan Workers: Queue-based (RabbitMQ/Redis)                  â”‚
â”‚  â”œâ”€ Database: PostgreSQL read replicas                          â”‚
â”‚  â””â”€ CDN: CloudFlare for widget bundle                           â”‚
â”‚                                                                 â”‚
â”‚   PERFORMANCE OPTIMIZATION                                      â”‚
â”‚  â”œâ”€ Template caching (in-memory Redis)                          â”‚
â”‚  â”œâ”€ Contract code caching (24h TTL)                             â”‚
â”‚  â”œâ”€ Lazy template loading (load on-demand)                      â”‚
â”‚  â””â”€ Parallel pattern matching (Worker threads)                  â”‚
â”‚                                                                 â”‚
â”‚   DATA MANAGEMENT                                               â”‚
â”‚  â”œâ”€ Scan results: 90-day retention                              â”‚
â”‚  â”œâ”€ Analytics: Time-series DB (InfluxDB)                        â”‚
â”‚  â”œâ”€ Logs: Centralized (ELK stack)                               â”‚
â”‚  â””â”€ Backups: Daily snapshots                                    â”‚
â”‚                                                                 â”‚
â”‚   MONITORING                                                    â”‚
â”‚  â”œâ”€ Prometheus metrics                                          â”‚
â”‚  â”œâ”€ Grafana dashboards                                          â”‚
â”‚  â”œâ”€ Error tracking (Sentry)                                     â”‚
â”‚  â””â”€ Uptime monitoring (UptimeRobot)                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Future Architecture Extensions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ROADMAP ARCHITECTURE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   Q1 2026 - Enhanced Analysis                                   â”‚
â”‚  â”œâ”€ Machine Learning integration                                â”‚
â”‚  â”‚  â”œâ”€ Pattern discovery (unsupervised learning)                â”‚
â”‚  â”‚  â”œâ”€ False positive reduction                                 â”‚
â”‚  â”‚  â””â”€ Exploit prediction models                                â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€ Multi-language support                                      â”‚
â”‚  â”‚  â”œâ”€ Vyper contracts                                          â”‚
â”‚  â”‚  â”œâ”€ Rust (Solana/NEAR)                                       â”‚
â”‚  â”‚  â””â”€ Move (Aptos/Sui)                                         â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€ Advanced static analysis                                    â”‚
â”‚     â”œâ”€ Data flow analysis                                       â”‚
â”‚     â”œâ”€ Control flow graphs                                      â”‚
â”‚     â””â”€ Symbolic execution                                       â”‚
â”‚                                                                 â”‚
â”‚   Q2 2026 - Multi-Chain Expansion                               â”‚
â”‚  â”œâ”€ L2 Support                                                  â”‚
â”‚  â”‚  â”œâ”€ Optimism                                                 â”‚
â”‚  â”‚  â”œâ”€ Arbitrum                                                 â”‚
â”‚  â”‚  â”œâ”€ Polygon zkEVM                                            â”‚
â”‚  â”‚  â””â”€ Base                                                     â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€ Alt-L1 Support                                              â”‚
â”‚  â”‚  â”œâ”€ Solana                                                   â”‚
â”‚  â”‚  â”œâ”€ Avalanche                                                â”‚
â”‚  â”‚  â””â”€ BNB Chain                                                â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€ Cross-chain security analysis                               â”‚
â”‚                                                                 â”‚
â”‚   Q3 2026 - Ecosystem Integration                               â”‚
â”‚  â”œâ”€ GitHub Actions integration                                  â”‚
â”‚  â”œâ”€ VS Code extension                                           â”‚
â”‚  â”œâ”€ Remix IDE plugin                                            â”‚
â”‚  â”œâ”€ Foundry integration                                         â”‚
â”‚  â””â”€ CI/CD pipelines (CircleCI, GitLab)                          â”‚
â”‚                                                                 â”‚
â”‚   Q4 2026 - Enterprise Features                                 â”‚
â”‚  â”œâ”€ Custom template marketplace                                 â”‚
â”‚  â”œâ”€ White-label solutions                                       â”‚
â”‚  â”œâ”€ SLA guarantees                                              â”‚
â”‚  â”œâ”€ Dedicated support                                           â”‚
â”‚  â””â”€ On-premise deployment                                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

